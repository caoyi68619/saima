import"./vendor.9f72332b.js";import{_ as e,g as l,r,s as a,v as o,x as s,y as u,b as t,c as d,w as i,l as n,f as p,m as c,d as m,q as g,D as v,z as f,A as k,B as F,C as b,h as _,G as h}from"./index.6a7a1d98.js";const y=["src"],j={class:"dialog-footer"};var x=e({__name:"DialogAddSwiper",props:{type:String,reload:Function},setup(e,{expose:x}){const U=e,V=l(null),w=r({uploadImgServer:a,token:o("token")||"",visible:!1,ruleForm:{url:"",link:"",sort:""},rules:{url:[{required:"true",message:"图片不能为空",trigger:["change"]}],sort:[{required:"true",message:"排序不能为空",trigger:["change"]}]},id:""}),D=e=>{const l=e.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(l))return g.error("请上传 jpg、jpeg、png 格式的图片"),!1},S=e=>{w.ruleForm.url=e.data||""},I=()=>{console.log(V.value.validate),V.value.validate((e=>{e&&("add"==U.type?v.post("/carousels",{carouselUrl:w.ruleForm.url,redirectUrl:w.ruleForm.link,carouselRank:w.ruleForm.sort}).then((()=>{g.success("添加成功"),w.visible=!1,U.reload&&U.reload()})):v.put("/carousels",{carouselId:w.id,carouselUrl:w.ruleForm.url,redirectUrl:w.ruleForm.link,carouselRank:w.ruleForm.sort}).then((()=>{g.success("修改成功"),w.visible=!1,U.reload&&U.reload()})))}))};return x({open:e=>{w.visible=!0,e?(w.id=e,(e=>{v.get(`/carousels/${e}`).then((e=>{w.ruleForm={url:e.carouselUrl,link:e.redirectUrl,sort:e.carouselRank}}))})(e)):w.ruleForm={url:"",link:"",sort:""}},close:()=>{w.visible=!1}}),(l,r)=>{const a=s("Plus"),o=u,g=f,v=k,x=F,U=b,R=_,q=h;return t(),d(q,{title:"add"==e.type?"添加轮播图":"修改轮播图",modelValue:w.visible,"onUpdate:modelValue":r[3]||(r[3]=e=>w.visible=e),width:"400px"},{footer:i((()=>[n("span",j,[p(R,{onClick:r[2]||(r[2]=e=>w.visible=!1)},{default:i((()=>r[4]||(r[4]=[c("取 消")]))),_:1}),p(R,{type:"primary",onClick:I},{default:i((()=>r[5]||(r[5]=[c("确 定")]))),_:1})])])),default:i((()=>[p(U,{model:w.ruleForm,rules:w.rules,ref_key:"formRef",ref:V,"label-width":"100px",class:"good-form"},{default:i((()=>[p(v,{label:"图片",prop:"url"},{default:i((()=>[p(g,{class:"avatar-uploader",action:w.uploadImgServer,accept:"jpg,jpeg,png",headers:{token:w.token},"show-file-list":!1,"before-upload":D,"on-success":S},{default:i((()=>[w.ruleForm.url?(t(),m("img",{key:0,style:{width:"200px",height:"100px",border:"1px solid #e9e9e9"},src:w.ruleForm.url,class:"avatar"},null,8,y)):(t(),d(o,{key:1,class:"avatar-uploader-icon"},{default:i((()=>[p(a)])),_:1}))])),_:1},8,["action","headers"])])),_:1}),p(v,{label:"跳转链接",prop:"link"},{default:i((()=>[p(x,{type:"text",modelValue:w.ruleForm.link,"onUpdate:modelValue":r[0]||(r[0]=e=>w.ruleForm.link=e)},null,8,["modelValue"])])),_:1}),p(v,{label:"排序值",prop:"sort"},{default:i((()=>[p(x,{type:"number",modelValue:w.ruleForm.sort,"onUpdate:modelValue":r[1]||(r[1]=e=>w.ruleForm.sort=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}},[["__scopeId","data-v-6c3e84de"],["__file","D:/trail/js代码/vueProject/vue3-admin-main/src/components/DialogAddSwiper.vue"]]);export{x as D};
