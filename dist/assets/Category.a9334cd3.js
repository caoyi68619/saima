import"./vendor.9f72332b.js";/* empty css             *//* empty css               */import{_ as e,r as a,L as t,f as r,o as l,c as o,w as n,a as i,e as s,n as c,D as d,v as u,g as p,h as g,k as m,i as y,y as v,K as f,b,M as _,d as h,z as k,A as C,B as I,C as j,E as x,G as F,I as w,J as L}from"./index.f782953c.js";/* empty css                     *//* empty css              *//* empty css                 *//* empty css                   *//* empty css                *//* empty css                  */const S={class:"dialog-footer"};var V=e({__name:"DialogAddCategory",props:{type:String,reload:Function},setup(e,{expose:f}){const b=e,_=a(null),h=t(),k=r({visible:!1,categoryLevel:1,parentId:0,ruleForm:{name:"",rank:""},rules:{name:[{required:"true",message:"名称不能为空",trigger:["change"]}],rank:[{required:"true",message:"编号不能为空",trigger:["change"]}]},id:""}),C=()=>{_.value.validate((e=>{e&&("add"==b.type?d.post("/categories",{categoryLevel:k.categoryLevel,parentId:k.parentId,categoryName:k.ruleForm.name,categoryRank:k.ruleForm.rank}).then((()=>{u.success("添加成功"),k.visible=!1,b.reload&&b.reload()})):d.put("/categories",{categoryId:k.id,categoryLevel:k.categoryLevel,parentId:k.categoryLevel,categoryName:k.ruleForm.name,categoryRank:k.ruleForm.rank}).then((()=>{u.success("修改成功"),k.visible=!1,b.reload&&b.reload()})))}))};return f({open:e=>{if(k.visible=!0,e)k.id=e,(e=>{d.get(`/categories/${e}`).then((e=>{k.ruleForm={name:e.categoryName,rank:e.categoryRank},k.parentId=e.parentId,k.categoryLevel=e.categoryLevel}))})(e);else{const{level:e=1,parent_id:a=0}=h.query;k.ruleForm={name:"",rank:""},k.parentId=a,k.categoryLevel=e}},close:()=>{k.visible=!1}}),(e,a)=>{const t=p,r=g,d=m,u=y,f=v;return l(),o(f,{title:"add"==k.type?"添加分类":"修改分类",modelValue:k.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>k.visible=e),width:"400px"},{footer:n((()=>[i("span",S,[s(u,{onClick:a[2]||(a[2]=e=>k.visible=!1)},{default:n((()=>a[4]||(a[4]=[c("取 消")]))),_:1}),s(u,{type:"primary",onClick:C},{default:n((()=>a[5]||(a[5]=[c("确 定")]))),_:1})])])),default:n((()=>[s(d,{model:k.ruleForm,rules:k.rules,ref_key:"formRef",ref:_,"label-width":"100px",class:"good-form"},{default:n((()=>[s(r,{label:"商品名称",prop:"name"},{default:n((()=>[s(t,{type:"text",modelValue:k.ruleForm.name,"onUpdate:modelValue":a[0]||(a[0]=e=>k.ruleForm.name=e)},null,8,["modelValue"])])),_:1}),s(r,{label:"排序值",prop:"rank"},{default:n((()=>[s(t,{type:"number",modelValue:k.ruleForm.rank,"onUpdate:modelValue":a[1]||(a[1]=e=>k.ruleForm.rank=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}},[["__file","D:/trail/js代码/vueProject/vue3-admin-main/src/components/DialogAddCategory.vue"]]);const z={class:"header"},D=["onClick"],P=["onClick"];var T=e({__name:"Category",setup(e){const p=a(null),g=f(),m=t(),v=r({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",level:1,parent_id:0});b((()=>{T()})),_((()=>{console.log(v.pageSize)}));const S=g.afterEach((e=>{["category","level2","level3"].includes(e.name)&&T()}));h((()=>{S()}));const T=()=>{const{level:e=1,parent_id:a=0}=m.query;v.loading=!0,d.get("/categories",{params:{pageNumber:v.currentPage,pageSize:v.pageSize,categoryLevel:e,parentId:a}}).then((t=>{v.tableData=t.list,v.total=t.totalCount,v.currentPage=t.currPage,v.loading=!1,v.level=e,v.parentId=a}))},q=e=>{v.currentPage=e,T()},B=()=>{v.type="add",p.value.open()},N=e=>{v.multipleSelection=e},R=()=>{v.multipleSelection.length?d.delete("/categories",{data:{ids:v.multipleSelection.map((e=>e.categoryId))}}).then((()=>{u.success("删除成功"),T()})):u.error("请选择项")};return(e,a)=>{const t=y,r=k,m=C,f=I,b=j,_=x;return l(),o(_,{class:"category-container"},{header:n((()=>[i("div",z,[s(t,{type:"primary",icon:F(w),onClick:B},{default:n((()=>a[0]||(a[0]=[c("增加")]))),_:1},8,["icon"]),s(r,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:R},{reference:n((()=>[s(t,{type:"danger",icon:F(L)},{default:n((()=>a[1]||(a[1]=[c("批量删除")]))),_:1},8,["icon"])])),_:1})])])),default:n((()=>[s(f,{load:v.loading,ref:"multipleTable",data:v.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:N},{default:n((()=>[s(m,{type:"selection",width:"55"}),s(m,{prop:"categoryName",label:"分类名称"}),s(m,{prop:"categoryRank",label:"排序值",width:"120"}),s(m,{prop:"createTime",label:"添加时间",width:"200"}),s(m,{label:"操作",width:"220"},{default:n((e=>[i("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:a=>{return t=e.row.categoryId,v.type="edit",void p.value.open(t);var t}},"修改",8,D),i("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:a=>(e=>{const a=e.categoryLevel+1;4!=a?g.push({name:`level${a}`,query:{level:a,parent_id:e.categoryId}}):u.error("没有下一级")})(e.row)},"下级分类",8,P),s(r,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:a=>{return t=e.row.categoryId,void d.delete("/categories",{data:{ids:[t]}}).then((()=>{u.success("删除成功"),T()}));var t}},{reference:n((()=>a[2]||(a[2]=[i("a",{style:{cursor:"pointer"}},"删除",-1)]))),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["load","data"]),s(b,{background:"",layout:"prev, pager, next",total:v.total,"page-size":v.pageSize,"current-page":v.currentPage,onCurrentChange:q},null,8,["total","page-size","current-page"]),s(V,{ref_key:"addCate",ref:p,reload:T,type:v.type},null,8,["type"])])),_:1})}}},[["__file","D:/trail/js代码/vueProject/vue3-admin-main/src/views/Category.vue"]]);export{T as default};
